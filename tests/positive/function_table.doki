import "../../library/prelude.doki"

fib = n: a: b:
    match n with
        0 => a,
        _ => f "fib" (minus n 1) b (plus a b),
    end

fs = Cons (Cons "read_num" read_num)
        (Cons (Cons "fib" fib)
        (Cons (Cons "i64_to_string" i64_to_string)
        (Cons (Cons "println" println)
        Nil)))

lookup = Cons (Cons k v) t: s: match str_eq s k with
        True => v,
        False => lookup t s,
    end

f = s: lookup fs s

main = _:
    let _ = print "> "
    in f "println" (f "i64_to_string" (f "fib" (f "read_num" 0) 0 1))
